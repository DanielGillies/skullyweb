{{> header title="SKULLY Store: AR-1" cssfile='<link href="static/css/shopify.css" rel="stylesheet" type="text/css" media="all" />' bodyClass="store" preventPopup="true"}}
<div class="nav-container">
  {{> navbar}}

  <div class="main-container">
    <section class="bg-white">
      <div class="container">

        <div class="product-single">
          <div id="storemobile" class="description">
            <h4 class="uppercase">
              <span class="ar1font">SKULLY AR-
                <span class="skullyred">1</span>
              </span>
            </h4>
            <div class="mb32 mb-xs-24">
              <span class="mb16 number price">$1,499 USD</span>
              <br>
            </div>
            <p>
              The
              <span class="ar1font">SKULLY AR-
                <span class="skullyred">1</span>
              </span> is the first helmet to feature a built-in 180° Blindspot Camera and Heads-Up Display for unparalleled situational awareness and safety. Focus on what matters most: the road ahead.
            </p>
          </div>
          <div class="row mb24 mb-xs-48">
            <div class="col-md-5 col-sm-6">
              <div id="viewerwrap" style="">
                <img id="helmet_img" alt="Image">
                <span id="viewerloading" style="position: relative;width: 0%;margin: -25px 2%;border-radius: 7px;height: 25px;line-height: 25px;background: red;color: white;font-family: sans-serif;display: block;text-align: right;vertical-align: center;min-width: 80px;opacity: 0;transition:width 0.2s ease, opacity 1s;">Loading&nbsp;</span>
                <img src="static/img/360/perspective-arrow.png" id="viewerindicator" style="position: relative;width: 80%;margin: -15% 10% 0px 10%;opacity: 0;transition: opacity 1s;">
              </div>
              <img src="static/img/360/360.svg" onclick="switchToViewer()" style="margin-top:25px;cursor:pointer;" width="75px" title="360 viewer, look at the helmet from every angle.">
  <script type="text/javascript">
  var image_element = document.getElementById("helmet_img");
  var loading = document.getElementById("viewerloading");
  var viewerWrap = document.getElementById("viewerwrap");
  var indicator = document.getElementById("viewerindicator");
  var resolution = 8;
  var images = [];
  var index = 0;
  var mouseIsDown = false;
  var viewerIsActive = false;

  var imagesURL = "static/img/360/blackonwhite/[[framey]]_[[framex]].jpg"

  function switchToViewer () {
    if (images.length > resolution) {
      viewerIsActive = true;
      image_element.src = images[currentFrame].src;
      //setTimeout(function() {
      //  console.log("asjldlak");
      //  image_element.src = images[currentFrame].src;
      //}, 50);
      indicator.style.opacity = "1";
    } else if (images.length == 0) {
      indicator.style.opacity = "0";
      loading.style.opacity = "1";
      viewerIsActive = true;
      loadimages();
    } else {
      image_element.src = images[images.length-1].src;
      indicator.style.opacity = "0";
      loading.style.opacity = "1";
      viewerIsActive = true;
    }
  }

  //loadimages();
  function loadimages() {
    if (index > resolution) {
      index++;
      loading.style.opacity = "0";
      if (viewerIsActive) indicator.style.opacity = "1";
      return;
    }
    loading.style.width = (Math.round((index/resolution)*100-4))+"%";
    images[index] = new Image();
    images[index].addEventListener("load", function() {
      if (viewerIsActive) image_element.src = images[images.length-1].src;
      loadimages();
      }, false);
    images[index].onerror = function () {
      console.error("Cannot load image, retrying");
      index--;
      loadimages();
    }
    images[index].src = imagesURL.replace("[[framex]]", index).replace("[[framey]]", Math.round(resolution/2));

    index++;
  }

  var lastPosition = resolution;
  var currentFrame = resolution;
  var bufferPosition = lastPosition;

  var isJqueryLoadedYet = function () {
    console.log("hi")
    if (window.jQuery) {
      initViewer();
      return;
    } else setTimeout(isJqueryLoadedYet, 100);
  }
  isJqueryLoadedYet();

  function initViewer () {
  $('body').on("mousemove touchmove", function(e) {
    if (!image_element.src.includes(imagesURL.substring(0, imagesURL.indexOf("[[framey]]")))) viewerIsActive = false;

    if (index <= resolution || !mouseIsDown || !viewerIsActive) return
    else indicator.style.opacity = "0";

      var position = ptXY(e);

      var trigger = resolution;
      var offsetL = image_element.getBoundingClientRect().left;
      trigger = resolution - (((position.x-offsetL)/image_element.offsetWidth)*resolution);
      var result = (trigger - lastPosition);
      result = Math.round(result);

      result = result + currentFrame;
      while (result > resolution) result = result - resolution;
      while (result < 0) result = result+resolution;

      image_element.src = images[result].src;
      bufferPosition = result;
  });


  $(viewerWrap).on("mousedown touchstart", function(e) {
    if (!viewerIsActive) return;
    e.preventDefault();
    mouseIsDown = true;

    var position = ptXY(e);

    var offsetL = image_element.getBoundingClientRect().left;
    var positionX = Math.round(resolution - (((position.x-offsetL)/image_element.offsetWidth)*resolution));
    lastPosition = positionX;

    while (lastPosition > resolution) lastPosition = lastPosition - resolution;
    while (lastPosition < 0) lastPosition = lastPosition+resolution;
  });

  $('body').on("mouseup touchend", function(e) {
    e.preventDefault();
    mouseIsDown = false;
    currentFrame = bufferPosition;
  });
};

  function ptXY (e) {
    var out = {x:0, y:0};
    if(e.type == 'touchstart' || e.type == 'touchmove' || e.type == 'touchend' || e.type == 'touchcancel'){
      var touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];
      out.x = touch.pageX;
      out.y = touch.pageY;
    } else if (e.type == 'mousedown' || e.type == 'mouseup' || e.type == 'mousemove' || e.type == 'mouseover'|| e.type=='mouseout' || e.type=='mouseenter' || e.type=='mouseleave') {
      out.x = e.pageX;
      out.y = e.pageY;
    }
    return out;
  };
  </script>
            </div>
            <div class="col-md-5 col-md-offset-1 col-sm-6">
              <div id="storedesktop" class="description">
                <h4 class="uppercase">
                  <span class="ar1font">SKULLY AR-
                    <span class="skullyred">1</span>
                  </span>
                </h4>
                <div class="mb32 mb-xs-24">
                  <span class="mb16 number price"></span>
                  <br>
                </div>
                <p>
                  The
                  <span class="ar1font">SKULLY AR-
                    <span class="skullyred">1</span>
                  </span> is the first helmet to feature a built-in 180° Blindspot Camera and Heads-Up Display for unparalleled situational awareness and safety. Focus on what matters most: the road ahead.
                </p>
              </div>
              <!-- <hr class="mb48 mb-xs-24"> -->
              <form class="variant-selectors">

                <div class="color-picker picker-wrapper">
                  <div class="instructions emphasis">Choose a color:</div>
                  <div class="picker" id="color-picker"></div>
                </div>

                <div class="size-picker picker-wrapper">
                  <div class="instructions emphasis">Choose a size:</div>
                  <div class="picker" id="size-picker"></div>
                </div>

                <h6 id="affirmtext">To determine your helmet size, please see our Sizing Guide below.</h6>
                <button class="btn buy-button">Add To Cart</button>
              </form>
              <h6>Estimated delivery is summer 2016.</h6>
            </div>
          </div>
          <!--end of row-->
        </div>
        <!--end of product single-->

        <!--end of row-->
          <div class="row sizing-guide">
            <div class="col-sm-12">
              <div class="tabbed-content text-tabs">
                <ul class="tabs">
                  <li class="active">
                    <div class="tab-title">
                      <span>Sizing Guide</span>
                    </div>
                    <div class="tab-content">
                      <table class="table table-bordered">
                        <thead>
                          <tr>
                            <th>
                              <span class="ar1font">SKULLY AR-
                                <span class="skullyred">1</span>
                              </span>
                            </th>
                            <th>HAT SIZE</th>
                            <th>CM</th>
                            <th>INCHES</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td style="font-weight: bold">S</td>
                            <td>6
                              <sup>7/8</sup> - 7</td>
                            <td>55 - 56</td>
                            <td>21
                              <sup>5/8</sup> - 22</td>
                          </tr>
                          <tr>
                            <td style="font-weight: bold">M</td>
                            <td>7
                              <sup>1/8</sup> - 7
                              <sup>1/4</sup>
                            </td>
                            <td>57 - 58</td>
                            <td>22
                              <sup>1/2</sup> - 22
                              <sup>7/8</sup>
                            </td>
                          </tr>
                          <tr>
                            <td style="font-weight: bold">L</td>
                            <td>7
                              <sup>3/8</sup> - 7
                              <sup>1/2</sup>
                            </td>
                            <td>59 - 60</td>
                            <td>23
                              <sup>1/4</sup> - 23
                              <sup>5/8</sup>
                            </td>
                          </tr>
                          <tr>
                            <td style="font-weight: bold">XL</td>
                            <td>7
                              <sup>1/2</sup> - 7
                              <sup>5/8</sup>
                            </td>
                            <td>60 - 61</td>
                            <td>23
                              <sup>5/8</sup> - 24</td>
                          </tr>
                          <tr>
                            <td style="font-weight: bold">XXL</td>
                            <td>7
                              <sup>5/8</sup> - 7
                              <sup>3/4</sup>
                            </td>
                            <td>61 - 62</td>
                            <td>24 - 24
                              <sup>3/8</sup>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </li>
                  <li>
                    <div class="tab-title">
                      <span>Description</span>
                    </div>
                    <div class="tab-content">
                      <p class="bold">Anthracite: Matte Black</p>
                      <p class="bold">Arctic White: Gloss White</p>
                      <p>
                        For more information, please visit the
                        <a href="/">
                          <span class="ar1font">SKULLY AR-
                            <span class="skullyred">1</span>
                          </span> page.</a>
                      </p>
                    </div>
                  </li>
                </ul>
              </div>
              <!--end of text tabs-->
            </div>
          </div>
          <!--end of row-->
        </div>
        <!--end of product single-->
        <!-- <h6>Interested in trying on a helmet in a store? <a href="map">Locate a Dealer</a></h6> -->

  <!-- .cart begin -->
  <div class="cart">

    <!-- .cart-section begin // cart header -->
    <div class="cart-section cart-section--top">
      <h2 class="cart-title">Your cart</h2>
      <button class="btn--close">
        <span aria-role="hidden">×</span>
        <span class="visuallyhidden">Close</span>
      </button>
    </div>
    <!-- .cart-section end -->

    <!-- .cart-form begin // cart body -->
    <div class="cart-form">
      <div class="cart-item-container cart-section">

      </div>

      <!-- .cart-bottom begin -->
      <div class="cart-bottom">
        <div class="cart-info clearfix cart-section">
          <div class="type--caps cart-info__total cart-info__small">Total</div>
          <div class="cart-info__pricing">
            <span class="cart-info__small cart-info__total">USD</span>
            <span class="pricing pricing--no-padding"></span>
          </div>
        </div>
        <div class="cart-actions-container cart-section type--center">
          <div class="cart-discount-notice cart-info__small">Shipping and discount codes are added at checkout.</div>
          <input type="submit" class="btnShop btn--cart-checkout" id="checkout" name="checkout" value="Checkout">
        </div>
      </div>
      <!-- .cart-bottom end -->

    </div>
    <!-- .cart-form end -->

  </div>
  <!-- .cart end -->

  <!-- .cart-tab start -->
  <button class="btnShop btn--cart-tab">
    <div class="btn__counter"></div>
    <svg xmlns="http://www.w3.org/2000/svg" class="icon-cart icon-cart--side" viewBox="0 0 25 25" enable-background="new 0 0 25 25"><g fill="#fff"><path d="M24.6 3.6c-.3-.4-.8-.6-1.3-.6h-18.4l-.1-.5c-.3-1.5-1.7-1.5-2.5-1.5h-1.3c-.6 0-1 .4-1 1s.4 1 1 1h1.8l3 13.6c.2 1.2 1.3 2.4 2.5 2.4h12.7c.6 0 1-.4 1-1s-.4-1-1-1h-12.7c-.2 0-.5-.4-.6-.8l-.2-1.2h12.6c1.3 0 2.3-1.4 2.5-2.4l2.4-7.4v-.2c.1-.5-.1-1-.4-1.4zm-4 8.5v.2c-.1.3-.4.8-.5.8h-13l-1.8-8.1h17.6l-2.3 7.1z"></path><circle cx="9" cy="22" r="2"></circle><circle cx="19" cy="22" r="2"></circle></g></svg>
  </button>
  <!-- .cart-tab end -->
      <!--end of container-->
    </section>
    {{> footer}}
  </div>
  {{> scripts}}

  <script type="text/javascript">
    document.getElementById('ShopifyEmbedScript') || document.write(
      '<script type="text/javascript" src="https://widgets.shopifyapps.com/assets/widgets/embed/client.js" id="ShopifyEmbedScript"><\/script>');
  </script>
  <script id="cart-item-template" type="text/template">
    <div class="cart-item">
      <div class="cart-item__img"></div>
      <div class="cart-item__content">
        <div class="cart-item__content-row">
          <div class="cart-item__variant-title"></div>
          <span class="cart-item__title"></span>
        </div>
        <div class="cart-item__content-row">
          <div class="cart-item__quantity-container">
            <button class="btn--seamless quantity-decrement" type="button"><span>-</span><span class="visuallyhidden">Decrement</span></button>
            <input class="cart-item__quantity" type="number" min="0" aria-label="Quantity">
            <button class="btn--seamless quantity-increment" type="button"><span>+</span><span class="visuallyhidden">Increment</span></button>
          </div>
          <span class="cart-item__price"></span>
        </div>
      </div>
    </div>
  </script>
  <noscript>
    <a href="https://skullysystems.myshopify.com/cart/5972989700:1" target="_blank">Buy SKULLY AR-1</a>
  </noscript>

  <script src="static/js/shopify.js"></script>
  <script src="https://sdks.shopifycdn.com/js-buy-sdk/latest/shopify-buy.polyfilled.globals.min.js"></script>
  </body>
  </html>
